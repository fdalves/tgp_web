<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:o="http://omnifaces.org/ui"
	xmlns:of="http://omnifaces.org/functions"
	xmlns:p="http://primefaces.org/ui"
	xmlns:pe="http://primefaces.org/ui/extensions">


<f:view contentType="text/html">
	<h:head>
		<style type="text/css" media="screen">
.ui-widget,.ui-widget .ui-widget {
	font-size: 11px !important;
}
</style>
	</h:head>
	

	
</f:view>







<h:form id="form">

	<p:growl id="messages" showDetail="true" />

	<pe:layout resizerTip="Resize Me" togglerTipClosed="Open Me"
		togglerTipOpen="Close Me">
		<pe:layoutPane position="north" size="80" closable="false">
			<p:graphicImage url="../imagens/uptiva_projetos.jpg" width="100%"
				height="100%" />
		</pe:layoutPane>
		<pe:layoutPane position="center">
			<pe:layoutPane position="north" size="50%" style="width: 80%;">


				<p:dataTable id="dataTable" var="ativ"
					value="#{initTgpMB.atividadesList}" widgetVar="dataTable"
					paginator="true" rows="5" resizableColumns="true" liveResize="true">

					<f:facet name="header">
            			Atividades
  					</f:facet>

					<p:column filterBy="#{ativ.atividadeNome}" headerText="Atividade"
						filterMatchMode="contains" width="20%">
						<h:outputText value="#{ativ.atividadeNome}" />
					</p:column>



					<p:column filterBy="#{ativ.projeto.nomeProjeto}"
						headerText="Projetos" filterMatchMode="exact" width="20%">
						<f:facet name="filter">
							<p:selectOneMenu onchange="PF('dataTable').filter()">
								<f:selectItem itemLabel="Select One" itemValue="#{null}"
									noSelectionOption="true" />
								<f:selectItems value="#{initTgpMB.nomesProjetos}" />
							</p:selectOneMenu>
						</f:facet>
						<h:outputText value="#{ativ.projeto.nomeProjeto}" />

					</p:column>

					<p:column headerText="Data Ini." width="8%"
						style="text-align: center; ">
						<h:outputText value="#{ativ.dtIni}">
							<f:convertDateTime locale="pt,BR" dateStyle="default"
								pattern="dd/MM/yyyy" />
						</h:outputText>
					</p:column>




					<p:column headerText="Data Fim." width="8%"
						style="text-align: center;">
						<h:outputText value="#{ativ.dtFim}">
							<f:convertDateTime locale="pt,BR" dateStyle="default"
								pattern="dd/MM/yyyy" />
						</h:outputText>
					</p:column>



					<p:column filterBy="#{ativ.prioridade}" style="text-align: center;"
						filterMatchMode="in">
						<f:facet name="filter">
							<p:selectCheckboxMenu label="Prioridade"
								onchange="PF('dataTable').filter()" panelStyle="width:80px">
								<f:selectItems value="#{initTgpMB.prioridades}" />
							</p:selectCheckboxMenu>
						</f:facet>
						<h:outputText value="#{ativ.prioridade}" />
					</p:column>

			        
					<p:column headerText="Desc." style="text-align: center;" width="8%">
						<p:commandButton icon="fa fa-list-alt" value="Desc."
							process="@this,:form:desc,:form:descGrid"
							update=":form:desc,:form:descGrid"
							oncomplete="PF('dlgDesc').show()">
							<f:setPropertyActionListener value="#{ativ}"
								target="#{initTgpMB.atividadeAtual}" />
						</p:commandButton>
					</p:column>


					<p:column headerText="Docs." style="text-align: center;">
						<p:commandButton icon="fa fa-file" value="Docs." ajax="true"
							process="@this" 
							actionListener="#{initTgpMB.initDoc(ativ)}"
							 oncomplete="javascript:centro('http://#{loginMB.hostName}:8080/tgp_web/pages/docAtividade.xhtml','_blank','800','700','no','no','no','no','no','no','no','yes','no')">
							<f:setPropertyActionListener value="#{ativ}"
								target="#{initTgpMB.atividadeAtual}" />
						</p:commandButton>
					</p:column>


					<p:column headerText="Situação" style="text-align: center;">
						<p:commandButton icon="fa fa-file" value="Docs." />
					</p:column>


					<p:column headerText="Apropriação H." style="text-align: center;">
						<p:commandButton icon="fa fa-pencil-square-o" value="Aprop." actionListener="#{initTgpMB.initApropHoras(ativ)}"
							process="@this" update=":form:apropAtiv,:form:output,:form:txt2" 
							oncomplete="PF('dlApropAtiv').show()">
							<f:setPropertyActionListener value="#{ativ}"
								target="#{initTgpMB.atividadeAtual}" />
						</p:commandButton>
					</p:column>


				</p:dataTable>



			</pe:layoutPane>
			<pe:layoutPane position="center" minHeight="60">
				<f:facet name="header">
            			Calendario Atividades
  			</f:facet>
				<center>

					<h:panelGrid columnClasses="value">

						<p:schedule id="schedule" value="#{scheduleView.eventModel}"
							widgetVar="myschedule" locale="pt">

							<p:ajax event="dateSelect"
								listener="#{scheduleView.onDateSelect}"
								update=":form:eventDetails"
								oncomplete="PF('eventDialog').show();" />
							<p:ajax event="eventSelect"
								listener="#{scheduleView.onEventSelect}"
								update=":form:eventDetails"
								oncomplete="PF('eventDialog').show();" />
							<p:ajax event="eventMove" listener="#{scheduleView.onEventMove}"
								update=":form:messages" />
							<p:ajax event="eventResize"
								listener="#{scheduleView.onEventResize}" update=":form:messages" />

						</p:schedule>


					</h:panelGrid>
				</center>
			</pe:layoutPane>
		</pe:layoutPane>
		<pe:layoutPane position="west" size="180">

			<pe:layoutPane position="center" minHeight="60">

				<p:panelMenu style="width:165px">
					<p:submenu label="Admin Menu">
						<p:menuitem value="CRUD Usuário" icon="fa fa-users" ajax="false"
							action="go_user" immediate="true" />
						<p:menuitem value="CRUD Projeto" icon="fa fa-sitemap" ajax="false"
							action="go_proj" immediate="true" />
						<p:menuitem value="CRUD Atividade" icon="fa fa-newspaper-o"
							ajax="false" action="go_ativ" immediate="true" />
					</p:submenu>
					<p:submenu label="User Menu">
						<p:menuitem value="Home" ajax="false" icon="fa fa-home" />
						<p:menuitem value="Agendar Meeting" ajax="false"
							icon="fa fa-gears" />
						<p:menuitem value="Minhas Atividades" ajax="false"
							icon="fa fa-list-alt" />
						<p:menuitem value="Calendário" ajax="false" icon="fa fa-calendar" />
					</p:submenu>
					<p:separator />
					<p:submenu label="Comunication Menu">
						<p:menuitem value="Web Chat RTC" icon="fa fa-comments"
							onclick="myWindow = window.open('http://#{loginMB.hostName}:8080/tgp_web/webChatRTC/index.jsf', 'myWindow', 'width=700, height=500');" />
						<p:menuitem value="Meeting RTC" icon="fa fa-video-camera"
							onclick="myWindow = window.open('http://#{loginMB.hostName}:8080/tgp_web/pages/RTCMultiConnection.xhtml', 'myWindow', 'width=1200, height=600');" />
					</p:submenu>

					<p:submenu label="Relatórios">
						<p:menuitem value="Report 1" ajax="false" icon="fa fa-file-pdf-o" />
						<p:menuitem value="Report 2" ajax="false" icon="fa fa-file-pdf-o" />
						<p:menuitem value="Report 3" ajax="false" icon="fa fa-file-pdf-o" />

					</p:submenu>

				</p:panelMenu>

			</pe:layoutPane>

		</pe:layoutPane>

	</pe:layout>




	<p:dialog widgetVar="eventDialog" header="Event Details"
		showEffect="clip" hideEffect="clip">
		<h:panelGrid id="eventDetails" columns="2">
			<h:outputLabel for="title" value="Title:" />
			<p:inputText id="title" value="#{scheduleView.event.title}" />

			<h:outputLabel for="from" value="From:" />
			<p:inputMask id="from" value="#{scheduleView.event.startDate}"
				mask="99/99/9999">
				<f:convertDateTime pattern="dd/MM/yyyy" timeZone="GMT+2" />
			</p:inputMask>

			<h:outputLabel for="to" value="To:" />
			<p:inputMask id="to" value="#{scheduleView.event.endDate}"
				mask="99/99/9999">
				<f:convertDateTime pattern="dd/MM/yyyy" timeZone="GMT+2" />
			</p:inputMask>

			<h:outputLabel for="allDay" value="All Day:" />
			<h:selectBooleanCheckbox id="allDay"
				value="#{scheduleView.event.allDay}" />

			<p:commandButton type="reset" value="Reset" />
			<p:commandButton id="addButton" value="Save"
				actionListener="#{scheduleView.addEvent}"
				oncomplete="PF('myschedule').update();PF('eventDialog').hide();" />
		</h:panelGrid>
	</p:dialog>






	<p:dialog id="desc" header="Desc. Atividade" widgetVar="dlgDesc"
		width="300px" minimizable="true" maximizable="true">
		<h:panelGrid id="descGrid" columns="2">
			<h:outputLabel value="Desc. Atividade" />
			<p:inputTextarea rows="8"
				value="#{initTgpMB.atividadeAtual.descAtividade}" readonly="true" />

		</h:panelGrid>

	</p:dialog>


	

   <p:dialog id="apropAtiv" header="Apropriação de Horas"   
		widgetVar="dlApropAtiv" width="800px" height="700px" minimizable="true"
		maximizable="true">
		<p:panel>
			<f:facet name="header">
            			Tempo Estimado da Atividade
  			</f:facet>
			
			<h:panelGrid columns="2" id="pgPop" cellpadding="5">
				
				<h:outputLabel value="G.P. Resposável" />
				<p:outputLabel value="#{initTgpMB.atividadeAtual.gerente.nome}"></p:outputLabel>
				<p:outputLabel value="Data Ini." />
				<h:outputText value="#{initTgpMB.atividadeAtual.dtIni}">
					<f:convertDateTime locale="pt,BR" dateStyle="default" pattern="dd/MM/yyyy" />
				</h:outputText>
				
				<p:outputLabel value="Data Fim." />
				<h:outputText value="#{initTgpMB.atividadeAtual.dtFim}">
					<f:convertDateTime locale="pt,BR" dateStyle="default" pattern="dd/MM/yyyy" />
				</h:outputText>


				
				<h:outputLabel value="Horas p/ Dia:" />
				<p:outputLabel value="#{initTgpMB.configAtividadeAtual.quantHorasDias}" />
					
				
				<h:outputLabel value="Feriados/Folgas no Periodo" />
				<h:outputLabel value="#{atividadeMB.maxFeriados}" />
				
							
				
				<h:outputLabel	style="font-weight:bold;font-size:13px;cellpadding=5;" id="diasId"
						value="Dias Trabalho Estimados: #{initTgpMB.usuarioAtividadeAtual.diasTrabalhados}" />
				
				<h:outputLabel	style="font-weight:bold;font-size:13px;padding-left: 50‒;cellpadding=5;padding-left: 10px;padding-right: 10;"
						id="horasId"
						value="Horas de Trabalho Estimadas: #{initTgpMB.usuarioAtividadeAtual.horasTrabalho}" />
				
				</h:panelGrid>
				
				<p:dataTable id="dataTableUserAtivaaa" var="usuativ"
				value="#{initTgpMB.usuarioAtividades}" paginator="true" rows="5">



			<p:column headerText="Usuário">
				<h:outputText value="#{usuativ.usuario.nome}" />
			</p:column>

			<p:column headerText="Horas Previstas">
				<h:outputText value="#{usuativ.horasTrabalho}" />
			</p:column>

			<p:column headerText="Horas Alocadas">
				<h:outputText value="#{usuativ.horasApropriadas}" />
			</p:column>

		</p:dataTable>
			
		</p:panel>
		
		<p:spacer height="10px" ></p:spacer>
		
		<p:panel>
			<f:facet name="header">
            			Apropriação de Horas na Atividade
  			</f:facet>
			
			<h:panelGrid columns="2" id="pgas" cellpadding="5">
				
				<h:outputLabel for="step" value="Horas Trabalhadas: " />
        		<p:spinner id="step"  stepFactor="0.5" value="#{initTgpMB.usuarioAtividadeAtual.horasApropriadas}" />
				
				<h:outputLabel value="Percentual de Conclusão:" />
				
			    <h:panelGrid columns="1" id="sliderId"  style="margin-bottom: 10px">
			        <h:outputText id="output" value="Aproximadamente %#{initTgpMB.percentApro}" />
			        <h:inputHidden id="txt2" value="#{initTgpMB.percentApro}" />
			        <p:slider for="txt2" display="output" style="width: 200px" displayTemplate="Aproximadamente %{value}" />
			    </h:panelGrid>
				
			</h:panelGrid>
			
			<center>
				<p:commandButton value="Save" ajax="true" process="@this" actionListener="#{initTgpMB.saveApro()}"  />
				<p:commandButton value="Reset" />
			</center>
		</p:panel>	
	</p:dialog>


</h:form>







<h:outputStylesheet library="css" name="global.css" />

<h:outputStylesheet id="layoutCSS">  
    body {  
        margin: 4px !important;  
    }  
</h:outputStylesheet>


<script type="text/javascript">

function centro(p,n,l,a,v1,v2,v3,v4,v5,v6,v7,v8,v9){
var l = l;
var a = a;
var t = (screen.height/2)-(a/2);
var d = (screen.width/2)-(l/2);
window.open(p,n,'width='+l+',height='+a+',top='+t+',left='+d+',scrollbars='+v1+',menubar='+v2+',directories='+v3+',location='+v4+',copyhistory='+v5+',status='+v6+',toolbar='+v7+',maximized='+v8+',resizable='+v9+'');
}

</script>


<script type="text/javascript">
    PrimeFaces.locales['pt'] = {
    		closeText: 'Fechar',    
            prevText: 'Anterior',    
            nextText: 'Próximo',    
            currentText: 'Começo',    
            monthNames: ['Janeiro','Fevereiro','Março','Abril','Maio','Junho','Julho','Agosto','Setembro','Outubro','Novembro','Dezembro'],    
            monthNamesShort: ['Jan','Fev','Mar','Abr','Mai','Jun', 'Jul','Ago','Set','Out','Nov','Dez'],    
            dayNames: ['Domingo','Segunda','Terça','Quarta','Quinta','Sexta','Sábado'],    
            dayNamesShort: ['Dom','Seg','Ter','Qua','Qui','Sex','Sáb'],    
            dayNamesMin: ['D','S','T','Q','Q','S','S'],    
            weekHeader: 'Semana',    
            firstDay: 1,    
            isRTL: false,    
            showMonthAfterYear: false,    
            yearSuffix: '',    
            timeOnlyTitle: 'Só Horas',    
            timeText: 'Tempo',    
            hourText: 'Hora',    
            minuteText: 'Minuto',    
            secondText: 'Segundo',    
            currentText: 'Data Atual',    
            ampm: false,    
            month: 'Mês',    
            week: 'Semana',    
            day: 'Dia',    
            allDayText : 'Todo Dia'  
    };
</script>
<style type="text/css">
.value {
	width: 1000px;
}
</style>


</html>
